<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width"><title>Autotest Growl notifications on Windows (using Snarl) - Karl O'Keeffe</title><link rel="alternate" href="/feed.xml" type="application/rss+xml" title=""><link rel="apple-touch-icon" href="/apple-touch-icon.png"><style>body {
  box-sizing: border-box;
  color: #333;
  font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
  font-size: 11px; /* For the PDF CV */
  letter-spacing: 0.2px;
  line-height: 1.6;
  -webkit-font-smoothing: antialiased;
  word-wrap: break-word;
}

.page {
  font-size: 16px; /* For the Website */
}

a {
  color: #2469C8;
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}

h1, h2, h3, h4, h5, h6, p, body, a, img, ul, ol, blockquote, pre {
  margin: 0; padding: 0; border: 0;
}

body {
  background-color: #ffffff;
  /*text-rendering: optimizeLegibility;*/
}

.content-wrap {
  width: 34em;
  margin: 0 auto;
}

p {
  margin-top: 0;
  margin-bottom: 16px;
}

h1 {
  font-size: 2em;
  margin-bottom: 1em;
}

h2 {
  position: relative;
  margin-top: 1em;
  margin-bottom: 16px;
  font-weight: bold;
  padding-bottom: .3em;
  font-size: 1.75em;
  line-height: 1.225;
  border-bottom: 1px solid #eee;
}

h3 {
  position: relative;
  margin-top: 1em;
  margin-bottom: 16px;
  font-weight: bold;
  font-size: 1.5em;
  line-height: 1.43;
}

ol, ul {
  padding: 0;
  padding-left: 2em;
  margin-top: 0;
  margin-bottom: 16px;
}

blockquote {
  margin: 1.2em 3em;
  padding-left: 1em;
  font-style: italic;
}

hr {
  border: 0;
  border-top: 1px dashed #d2d2d2;
  height: 0;
  margin: 1.6em 0;
}

/* page header */

.header {
  padding: 2em;
  background: #FFA91A;
}

.header h1 {
  font-size: 2.6em;
  text-align: center;
  font-weight: 700;
  margin: 0;
}

.header a, .header a:hover {
  text-decoration: none;
  color: #ffffff;
}

/* page footer */

footer {
  margin: 3em 0;
}

footer .nav {
  text-align: center;
  margin-top: 5em;
  margin-bottom: 3.5em;
}

footer .nav a {
  padding: 0 0.5em;
  font-size: 1.2em;
  text-decoration: none;
}

footer .about {
  padding: 2.2em 3em;
  text-align: center;
  color: #888;
}

/* article */

.article {
  margin: 3em 0 4em;
}

.article header .date {
  text-align: center;
  margin-top: -0.7em;
}

.article .content img {
  display: block;
  width: 100%;
}

/* code styling */

p code,
h2 code {
  font-family: Consolas,"Liberation Mono",Menlo,Courier,monospace;
  padding: 0;
  padding-top: .2em;
  padding-bottom: .2em;
  margin: 0;
  font-size: 85%;
  background-color: #f7f7f7;
  border-radius: 3px;
}

h2 code:before,
h2 code:after,
p code:before,
p code:after {
  letter-spacing: -0.2em;
  content: "\00a0";
}

pre {
  font-family: Consolas,"Liberation Mono",Menlo,Courier,monospace;
  word-wrap: normal;
  padding: 16px;
  overflow: auto;
  /*font-size: 100%;*/
  font-size: 13.6px;
  line-height: 1.45;
  background-color: #f7f7f7;
  border: 0;
  border-radius: 3px;
  margin-top: 0;
  margin-bottom: 16px;
}

pre code {
  display: inline;
  max-width: initial;
  padding: 0;
  margin: 0;
  overflow: initial;
  line-height: inherit;
  word-wrap: normal;
  background-color: transparent;
  border: 0;
  /*font-size: 100%;*/
  white-space: pre;
  background: transparent;
  border-radius: 3px;
}

/* syntax hl stuff */

code.lang-markdown {
  color: #424242;
}

code.lang-markdown .header,
code.lang-markdown .strong {
  font-weight: bold;
}

code.lang-markdown .emphasis {
  font-style: italic;
}

code.lang-markdown .horizontal_rule,
code.lang-markdown .link_label,
code.lang-markdown .code,
code.lang-markdown .header,
code.lang-markdown .link_url {
  color: #555;
}

code.lang-markdown .blockquote,
code.lang-markdown .bullet {
  color: #bbb;
}

/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
.tomorrow-comment, pre .comment, pre .title {
  color: #8e908c;
}

.tomorrow-red, pre .variable, pre .attribute, pre .tag, pre .regexp, pre .ruby .constant, pre .xml .tag .title, pre .xml .pi, pre .xml .doctype, pre .html .doctype, pre .css .id, pre .css .class, pre .css .pseudo {
  color: #c82829;
}

.tomorrow-orange, pre .number, pre .preprocessor, pre .built_in, pre .literal, pre .params, pre .constant {
  color: #f5871f;
}

.tomorrow-yellow, pre .class, pre .ruby .class .title, pre .css .rules .attribute {
  color: #eab700;
}

.tomorrow-green, pre .string, pre .value, pre .inheritance, pre .header, pre .ruby .symbol, pre .xml .cdata {
  color: #718c00;
}

.tomorrow-aqua, pre .css .hexcolor {
  color: #3e999f;
}

.tomorrow-blue, pre .function, pre .python .decorator, pre .python .title, pre .ruby .function .title, pre .ruby .title .keyword, pre .perl .sub, pre .javascript .title, pre .coffeescript .title {
  color: #4271ae;
}

.tomorrow-purple, pre .keyword, pre .javascript .function {
  color: #8959a8;
}

/* media queries */

@media (max-width: 690px) {
  .content-wrap {
    width: auto;
    padding: 0 1em;
  }
  .header {
    padding: 1em;
  }
  .header h1 {
    font-size: 1.4em;
  }
  .article {
    margin: 1em 0 2.5em;
  }
  .archive {
    width: 80%;
    margin: 0 auto;
  }
  .archive * {
    float: none !important;
    line-height: 1.6 !important;
    width: auto !important;
    height: auto !important;
    text-align: left !important;
    border: 0 !important;
    margin: 0 !important;
  }
  footer .nav {
    margin: 1em 0;
  }
  footer .about {
    padding: 0;
    padding-top: 1.6em;
  }
  footer .about p {
    margin-bottom: 1em;
  }
}
</style></head><body class="page"><header class="header"><div class="content-wrap"><div class="logo"><h1><a href="/">Karl O'Keeffe</a></h1></div></div></header><div id="content"><div class="content-wrap"><article class="article"><header><h2><a href="/blog/articles/autotest-growl-notifications-on-windows-using-snarl/">Autotest Growl notifications on Windows (using Snarl)</a></h2><p class="date"><span>19. June 2009</span></p></header><section class="content"><p><a href="/articles/simple-example-of-autotest-cucumber-and-growl/">Growl and Autotest work brilliantly together</a>. Autotest runs all your tests in the background every time a file changes, giving you extremely fast feedback on your test driven development. And Growl notifications save you from needing to flip back to the Terminal to see the result of each test run, you get an unobtrusive popup in the corner of your screen showing the success or failure of the<span class="widont">&nbsp;</span>tests.</p>
<p>But what about those users working on the Windows<span class="widont">&nbsp;</span>platform?</p>
<p><a href="http://www.fullphat.net/index.php">Snarl</a> is a windows counterpart to Growl. Providing much of the same<span class="widont">&nbsp;</span>functionality.</p>
<p>And there is a Snarl Ruby gem allowing us to create Snarl notifications from<span class="widont">&nbsp;</span>Ruby.</p>
<p>So lets convert our Growl calls to Snarl calls, and get Autotest notifications under<span class="widont">&nbsp;</span>Windows.</p>
<h2 id="installing-autotest-snarl-and-the-growl-to-snarl-converter">Installing Autotest, Snarl, and the Growl to Snarl<span class="widont">&nbsp;</span>converter</h2>
<p>If you haven’t already <a href="http://www.ruby-lang.org/en/downloads/">download and install<span class="widont">&nbsp;</span>Ruby</a>.</p>
<p>First up we need to <a href="http://www.fullphat.net/index.php">download and install<span class="widont">&nbsp;</span>Snarl</a>.</p>
<p>Then we need to install Autotest and the autotest-growl gem (that we are later going to override). Open a command prompt, and type the following (Autotest is part of the ZenTest<span class="widont">&nbsp;</span>gem):</p>
<pre><code class="language-bash">gem install ZenTest
gem install ruby-snarl
gem install autotest-growl</code></pre>
<p>Then save the code below to <code>lib/autotest/growl-to-snarl.rb</code> within your project. This code converts any Growl calls to equivalent Snarl<span class="widont">&nbsp;</span>calls.</p>
<h4 id="growl-to-snarl-rb">growl-to-snarl.rb</h4>
<pre><code class="language-ruby"><span class="keyword">require</span> <span class="string">'snarl'</span>
<span class="class"><span class="keyword">module</span> <span class="title">Autotest::Growl</span></span>

  <span class="comment"># Display a message through Snarl.</span>
  <span class="function"><span class="keyword">def</span> <span class="title">self</span>.<span class="title">growl</span> <span class="title">title</span>, <span class="title">message</span>, <span class="title">icon</span>, <span class="title">priority=</span>0, <span class="title">stick=</span>""</span>
    image = File.join(<span class="caps">ENV</span>[<span class="string">'<span class="caps">HOME</span>'</span>], <span class="string">'.autotest-growl'</span>, <span class="string">"<span class="subst">#{icon}</span>.png"</span>)
    image = File.join(GEM_PATH, <span class="string">'img'</span>, <span class="string">"<span class="subst">#{icon}</span>.png"</span>) <span class="keyword">unless</span> File.exists?(image)

    Snarl.show_message(title, message.inspect, image)
  <span class="keyword">end</span>

<span class="keyword">end</span></code></pre>
<p>Next we need to update our <code>.autotest</code> configuration file to include the autotest-growl gem, and the Growl to Snarl converter. Add the following to your <code>.autotest</code> file in the project root<span class="widont">&nbsp;</span>directory.</p>
<pre><code class="language-ruby"><span class="keyword">require</span> <span class="string">'autotest-growl'</span>
<span class="keyword">require</span> <span class="string">'snarl'</span>
<span class="keyword">require</span> <span class="string">'lib/autotest/growl-to-snarl'</span></code></pre>
<h2 id="running-autotest-with-snarl-support">Running Autotest with Snarl<span class="widont">&nbsp;</span>support</h2>
<p>First up ensure Snarl is running (check for the icon in the system<span class="widont">&nbsp;</span>tray).</p>
<p>Autotest will fail to run on Windows if a <code>HOME</code> environment variable doesn’t exist, so we need to create one before we run (I’ve also noticed that the Ruby <code>gem</code> command will fail to run if the <code>HOME</code> evironment variable <em>does</em> exist, which is<span class="widont">&nbsp;</span>frustrating!).</p>
<p>Open a command prompt, navigate to the project root directory. Then enter the following to set the <code>HOME</code> environment variable and run<span class="widont">&nbsp;</span>Autotest.</p>
<pre><code class="language-bash"><span class="built_in">set</span> <span class="caps">HOME</span>=<span class="string">"C:\Documents and Settings\username"</span>
autotest</code></pre>
<p>The results of your test runs should now display as Snarl<span class="widont">&nbsp;</span>notifications.</p>
</section></article></div></div><footer><div class="content-wrap"><div class="nav"><a href="/blog/">Full blog</a></div><section class="about"><p>Personal homepage of <a href="/">Karl O’Keeffe</a>.</p>
</section></div></footer></body></html>