<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width">
    <title>Autotest, Cucumber, and Growl - Karl O'Keeffe
    </title>
    <link rel="alternate" href="/feed.xml" type="application/rss+xml" title="">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    <style>body {
  box-sizing: border-box;
  color: #333;
  font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
  font-size: 11px; /* For the PDF CV */
  letter-spacing: 0.2px;
  line-height: 1.6;
  -webkit-font-smoothing: antialiased;
  word-wrap: break-word;
}

.page {
  font-size: 16px; /* For the Website */
}

a {
  color: #2469C8;
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}

h1, h2, h3, h4, h5, h6, p, body, a, img, ul, ol, blockquote, pre {
  margin: 0; padding: 0; border: 0;
}

body {
  background-color: #ffffff;
  /*text-rendering: optimizeLegibility;*/
}

.content-wrap {
  width: 34em;
  margin: 0 auto;
}

p {
  margin-top: 0;
  margin-bottom: 16px;
}

h1 {
  font-size: 2em;
  margin-bottom: 1em;
}

h2 {
  position: relative;
  margin-top: 1em;
  margin-bottom: 16px;
  font-weight: bold;
  padding-bottom: .3em;
  font-size: 1.75em;
  line-height: 1.225;
  border-bottom: 1px solid #eee;
}

h3 {
  position: relative;
  margin-top: 1em;
  margin-bottom: 16px;
  font-weight: bold;
  font-size: 1.5em;
  line-height: 1.43;
}

ol, ul {
  padding: 0;
  padding-left: 2em;
  margin-top: 0;
  margin-bottom: 16px;
}

blockquote {
  margin: 1.2em 3em;
  padding-left: 1em;
  font-style: italic;
}

hr {
  border: 0;
  border-top: 1px dashed #d2d2d2;
  height: 0;
  margin: 1.6em 0;
}

/* page header */

.header {
  padding: 2em;
  background: #FFA91A;
}

.header h1 {
  font-size: 2.6em;
  text-align: center;
  font-weight: 700;
  margin: 0;
}

.header a, .header a:hover {
  text-decoration: none;
  color: #ffffff;
}

/* page footer */

footer {
  margin: 3em 0;
}

footer .nav {
  text-align: center;
  margin-top: 5em;
  margin-bottom: 3.5em;
}

footer .nav a {
  padding: 0 0.5em;
  font-size: 1.2em;
  text-decoration: none;
}

footer .about {
  padding: 2.2em 3em;
  text-align: center;
  color: #888;
}

/* article */

.article {
  margin: 3em 0 4em;
}

.article header .date {
  text-align: center;
  margin-top: -0.7em;
}

.article .content img {
  display: block;
  width: 100%;
}

/* code styling */

p code,
h2 code {
  font-family: Consolas,"Liberation Mono",Menlo,Courier,monospace;
  padding: 0;
  padding-top: .2em;
  padding-bottom: .2em;
  margin: 0;
  font-size: 85%;
  background-color: #f7f7f7;
  border-radius: 3px;
}

h2 code:before,
h2 code:after,
p code:before,
p code:after {
  letter-spacing: -0.2em;
  content: "\00a0";
}

pre {
  font-family: Consolas,"Liberation Mono",Menlo,Courier,monospace;
  word-wrap: normal;
  padding: 16px;
  overflow: auto;
  /*font-size: 100%;*/
  font-size: 13.6px;
  line-height: 1.45;
  background-color: #f7f7f7;
  border: 0;
  border-radius: 3px;
  margin-top: 0;
  margin-bottom: 16px;
}

pre code {
  display: inline;
  max-width: initial;
  padding: 0;
  margin: 0;
  overflow: initial;
  line-height: inherit;
  word-wrap: normal;
  background-color: transparent;
  border: 0;
  /*font-size: 100%;*/
  white-space: pre;
  background: transparent;
  border-radius: 3px;
}

/* syntax hl stuff */

code.lang-markdown {
  color: #424242;
}

code.lang-markdown .header,
code.lang-markdown .strong {
  font-weight: bold;
}

code.lang-markdown .emphasis {
  font-style: italic;
}

code.lang-markdown .horizontal_rule,
code.lang-markdown .link_label,
code.lang-markdown .code,
code.lang-markdown .header,
code.lang-markdown .link_url {
  color: #555;
}

code.lang-markdown .blockquote,
code.lang-markdown .bullet {
  color: #bbb;
}

/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
.tomorrow-comment, pre .comment, pre .title {
  color: #8e908c;
}

.tomorrow-red, pre .variable, pre .attribute, pre .tag, pre .regexp, pre .ruby .constant, pre .xml .tag .title, pre .xml .pi, pre .xml .doctype, pre .html .doctype, pre .css .id, pre .css .class, pre .css .pseudo {
  color: #c82829;
}

.tomorrow-orange, pre .number, pre .preprocessor, pre .built_in, pre .literal, pre .params, pre .constant {
  color: #f5871f;
}

.tomorrow-yellow, pre .class, pre .ruby .class .title, pre .css .rules .attribute {
  color: #eab700;
}

.tomorrow-green, pre .string, pre .value, pre .inheritance, pre .header, pre .ruby .symbol, pre .xml .cdata {
  color: #718c00;
}

.tomorrow-aqua, pre .css .hexcolor {
  color: #3e999f;
}

.tomorrow-blue, pre .function, pre .python .decorator, pre .python .title, pre .ruby .function .title, pre .ruby .title .keyword, pre .perl .sub, pre .javascript .title, pre .coffeescript .title {
  color: #4271ae;
}

.tomorrow-purple, pre .keyword, pre .javascript .function {
  color: #8959a8;
}

/* media queries */

@media (max-width: 690px) {
  .content-wrap {
    width: auto;
    padding: 0 1em;
  }
  .header {
    padding: 1em;
  }
  .header h1 {
    font-size: 1.4em;
  }
  .article {
    margin: 1em 0 2.5em;
  }
  .archive {
    width: 80%;
    margin: 0 auto;
  }
  .archive * {
    float: none !important;
    line-height: 1.6 !important;
    width: auto !important;
    height: auto !important;
    text-align: left !important;
    border: 0 !important;
    margin: 0 !important;
  }
  footer .nav {
    margin: 1em 0;
  }
  footer .about {
    padding: 0;
    padding-top: 1.6em;
  }
  footer .about p {
    margin-bottom: 1em;
  }
}

    </style>
  </head>
  <body class="page">
    <header class="header">
      <div class="content-wrap">
        <div class="logo">
          <h1><a href="/">Karl O'Keeffe</a></h1>
        </div>
      </div>
    </header>
    <div id="content">
      <div class="content-wrap">
        <article class="article">
          <header>
            <h2><a href="/blog/articles/autotest-cucumber-and-growl/">Autotest, Cucumber, and Growl</a></h2>
            <p class="date"><span>15. June 2009</span></p>
          </header>
          <section class="content"><p><a href="http://ph7spot.com/articles/getting_started_with_autotest">Autotest</a> is a great Ruby tool to speed up test driven development by automatically running your tests every time a file is<span class="widont">&nbsp;</span>saved.</p>
<p><a href="http://cukes.info/">Cucumber</a> is an awesome tool for doing behavioural driven development. It allows you to write plain text automated acceptance<span class="widont">&nbsp;</span>tests.</p>
<p><a href="http://wiki.github.com/aslakhellesoy/cucumber/autotest-integration">Autotest and Cucumber work together seamlessly</a>, you just need to set the <code>AUTOFEATURE</code> environment variable to<span class="widont">&nbsp;</span>true:</p>
<pre><code class="lang-bash">$ AUTOFEATURE=<span class="literal">true</span>
</code></pre>
<p><a href="http://growl.info/">Growl</a> is an excellent notification system for <span class="caps">OSX</span> that allows applications to popup unobtrusive messages on the users desktop. (<a href="http://www.fullphat.net/index.php">Snarl</a> is the equivalent for<span class="widont">&nbsp;</span>windows)</p>
<p>You can <a href="http://github.com/svoop/autotest-growl/tree/master">add Growl support to Autotest (using the autotest-growl gem)</a> so that you get popup notifications of test<span class="widont">&nbsp;</span>results.</p>
<p><strong>But the current version of autotest-growl doesn’t provide notifications for the result of Autotest Cucumber<span class="widont">&nbsp;</span>runs.</strong></p>
<h2 id="cucumber-growl-support-in-autotest">Cucumber Growl support in<span class="widont">&nbsp;</span>Autotest</h2>
<p>So I’ve added support for notification of Autotest Cucumber results using growl. It’s super simple at the moment as I’m still pretty new at<span class="widont">&nbsp;</span>Ruby.</p>
<p>You need to have Autotest (part of the ZenTest gem), Autotest-Growl, and Growl already<span class="widont">&nbsp;</span>installed.</p>
<p>Save the code below to the file <code>growl-cucumber.rb</code>.</p>
<h4 id="growl-cucumber-rb">growl-cucumber.rb</h4>
<pre><code class="lang-ruby"><span class="keyword">require</span> <span class="string">'autotest'</span>

<span class="class"><span class="keyword">module</span> <span class="title">Autotest::Growl</span></span>

  <span class="comment"># Growl results of Cucumber</span>
  <span class="constant">Autotest</span>.add_hook <span class="symbol">:ran_features</span> <span class="keyword">do</span> |autotest|

    gist = autotest.results.grep(<span class="regexp">/\d+\s+scenario.*\)/</span>).join(<span class="string">" / "</span>).strip()
    <span class="keyword">if</span> gist == <span class="string">''</span>
      growl <span class="variable">@label</span> + <span class="string">'Cannot run features.'</span>, <span class="string">''</span>, <span class="string">'error'</span>
    <span class="keyword">else</span>
      <span class="keyword">if</span> gist =~ <span class="regexp">/[1-9]\d*\s+(failed)/</span>
        growl <span class="variable">@label</span> + <span class="string">'Some features have failed.'</span>, gist, <span class="string">'failed'</span>
      <span class="keyword">elsif</span> gist =~ <span class="regexp">/pending/</span>
        growl <span class="variable">@label</span> + <span class="string">'Some features are skipped.'</span>, gist, <span class="string">'skipped'</span>
      <span class="keyword">else</span>
        growl <span class="variable">@label</span> + <span class="string">'All features have passed.'</span>, gist, <span class="string">'passed'</span>
      <span class="keyword">end</span>
    <span class="keyword">end</span>
    <span class="keyword">false</span>
  <span class="keyword">end</span>

<span class="keyword">end</span>
</code></pre>
<p>Then update your .autotest configuration file to include the new growl-cucumber<span class="widont">&nbsp;</span>file:</p>
<h4 id="-autotest">.autotest</h4>
<pre><code class="lang-ruby"><span class="comment"># Add the growl and growl-cucumber requires to your .autotest config file </span>
<span class="keyword">require</span> <span class="string">'autotest/growl'</span>
<span class="keyword">require</span> <span class="string">'autotest/growl-cucumber'</span>
</code></pre>
<hr>
<h2 id="to-do">To Do</h2>
<p>I need to see if this can be integrated with the existing autotest-growl<span class="widont">&nbsp;</span>gem.</p>
</section>
        </article>
      </div>
    </div>
    <footer>
      <div class="content-wrap">
        <div class="nav"><a href="/blog/">Full blog</a></div>
        <section class="about"><p>Personal homepage of <a href="/">Karl O’Keeffe</a>.</p>

        </section>
      </div>
    </footer>
  </body>
</html>